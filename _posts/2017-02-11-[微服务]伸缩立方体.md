---
layout: post
title: '伸缩立方体'
date: 2017-02-11
author: Feihang Han
tags: 微服务
---

# \[微服务\]伸缩立方体

这本书《The Art of Scalability》描述了一个真正有用的三维可伸缩模型：伸缩立方体。

![](/assets/doc_imgs/DecomposingApplications.021.jpg)

在这个模型中，通过在负载均衡后面克隆应用实现扩展被称为X轴伸缩。伸缩的其他两种类型是Y轴和Z轴的伸缩。微服务架构是应用的Y轴的伸缩，但也让我们看看X轴和Z轴的伸缩。

# X轴伸缩

X轴伸缩是指在一个负载均衡后面运行多个应用的拷贝。如果有N个拷贝，则每一个拷贝处理1/N的负载。这是一个简单的，常用的方法来扩展一个应用。

这个方法的缺点是因为每一个应用的拷贝可以访问所有的数据，所以应用需要在缓存上花费更多的空间。另外一个问题是这个方法没有解决不断增加的开发和应用复杂度。

# Y轴伸缩

不同于X轴和Z轴，Y轴伸缩将应用拆分成多个不同的服务。每个服务负责一个或多个密切相关的功能。将应用程序分解成服务有几种不同的方法。一种方法是使用基于动词的分解，定义服务为实现一个单一的用例，比如结帐。另一种方法是基于名词的分解，定义服务为负责某个特定对象的所有的操作，比如客户管理。应用程序可以使用基于动词和基于名词的分解相结合的方法。

# Z轴伸缩

当使用Z轴伸缩时，每个服务器上运行一份完全相同的代码副本。在这方面，它类似于X轴伸缩。最大的区别是每个服务器只负责数据的一个子集。系统的一些组件负责将每个请求路由到合适的服务器。一个常用的路由标准是请求的属性，如被访问的实体的主键。另一个常见的路由标准是客户类型。例如，应用可以将SLA\(服务水平协议, Service Level Agressment\)更高的付费客户的请求路由到处理能力更强的服务器上去。

Z轴分割通常用于数据库伸缩。数据基于每条记录的某个属性，被分区（即分片）在不同的服务器。在本例中，RESTAURANT表的主键用于在两个不同数据库服务器间对数据行进行分区。请注意，每个分区可以通过部署一个或多个服务器作为备份/从服务器\(replicas/slaves\)来实现X轴的克隆。Z轴缩放也可以适用于应用程序。在本例中，搜索服务包含多个分区。路由器将每个内容项发送到适当的分区，并在其中存储数据与索引。查询聚合器将查询请求分发给所有分区，并将结果组合在一起。

优点：

* 每个服务器只处理数据的一个子集。

* 提高了缓存的利用率，减少了内存占用和I/O流量。

* 提高了事务的可伸缩性，因为请求通常分布在多台服务器上。

* 故障隔离，因为失败只是在访问数据的一部分。

缺点：

* 增加了应用程序的复杂性。

* 我们需要实现一个分区方案，可能很棘手，特别是当我们需要重新对数据进行分区时。

* 它没有解决不断增加的开发和应用复杂度。要解决这些问题需要我们用Y轴伸缩。

# 参考

[http://microservices.io/articles/scalecube.html](http://microservices.io/articles/scalecube.html)

